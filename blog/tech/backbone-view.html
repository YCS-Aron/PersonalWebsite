<div class="blog-body">
    <header class="header">
        <div class="title">
            <h1>Backbone的View</h1>
            <p class="subline">对Backbone的组件之一View的特性和使用方法的介绍</p>
            <p class="blog-time"><strong>姚川松</strong> &#8212; 写于 <strong>2015/7/2</strong></p>
        </div>
    </header>
    <article class="article-content">
        <div>
            <p>View是Backbone中用于渲染模板, 为模板绑定DOM事件和实现数据与页面元素的绑定的模块. 它往往需要与Model进行绑定, 从而获取Model中的数据, 并监听Model中的数据变化, 以实时的更新页面. 它还需要与Controller进行绑定, 从Controller中获取页面更新和业务转移等逻辑. 有时, 特殊的View还需要和Collection绑定, 比如CompositeView, 从而实现可定制的列表视图.</p>
            <p>Backbone的View组件提供了与页面功能相关的特性, 比如模板渲染, 可以通过JSON对象直接渲染出需要的HTML模板; DOM事件绑定, 用于对模板中的元素定义点击, 焦点, 按键等事件的响应; 监听数据变化, 以实时更新页面元素. </p>
            <h2>渲染模板</h2>
            <p>Backbone中的View通过Underscore提供的_.template方法加载模板, 并传入JSON对象实现渲染. 也可以使用其他的模板引擎加载模板, 比如Handlebars, 在此就不做详叙. 下面是一个例子: </p>
            <pre><code class="javascript">
var myView = Backbone.extend({
    render: function(){
        var temp = _.template($('#temp'));
        this.$el.html(temp({name: 'ycs'}));
    }
});
            </code></pre>
            <p>这里的模板是通过jQuery选择器查找出来的, 所以是写在页面上的. 为了更好的实现模块化, 可以将会重复使用的模板定义在一个html文件中, 需要时通过RequireJS加载, 然后使用模板引擎渲染. 下面是例子: </p>
<pre><code class="javascript">
var tmp = require('text!mytemplate.html');
var myView = Backbone.extend({
    template: tmp,
    render: function(){
        var temp = _.template(this.template);
        this.$el.html(temp({name: 'ycs'}));
    }
});
</code></pre>
            <div class="warning">
                <span>公司里的Backbone可能是自己定制的 ??????????, 加入了Handlebars.</span>
            </div>
            <h2>DOM事件绑定</h2>
            <p>页面必然要涉及到DOM事件的响应, View也继承了Events的方法, 所以View中的DOM事件的绑定也是通过Events模块事先的. 在View中定义事件名到响应函数的JSON对象, 属性名为events. 下面是一个例子:</p>
<pre><code class="javascript">
var myView = Backbone.extend({
    el: $('&lt;div&gt;&lt;button&gt;&lt;/button&gt;&lt;/div&gt;')
    events: {
        'click button': 'clickHandler'      //动作和元素用空格隔开, 元素满足jQuery选择器语法
    },
    clickHandler: function(){
        console.log('button is clicked.');
    }
});
</code></pre>
            <div class="warning">
                <span>View中可以为一个事件定义多个响应吗  ???????.</span>
            </div>
            <h2>监听数据变化</h2>
            <p>通过数据监听, 可以达到实时更新界面的目的. 数据监听是通过Events中的listenTo实现的. listenTo是用来监听另一个对象上的事件的方法. 此外, 还有stopListening, listenToOnce方法. 例子如下:</p>
<pre><code class="javascript">
var myView = Backbone.extend({
    render: function(){
        var temp = _.template('&lt;div&gt;&lt;span&gt;&lt;%=name%&gt;&lt;/span&gt;&lt;/div&gt;'));
        this.$el.html(temp({name: this.model.get('name')}));
    }
    initialize: function(){
        this.listenTo(this.model, 'change', function(){
            this.$el.text(this.model.get(name));
        });
    }
});
var myModel = new Backbone.Model({
    name: 'aron'
});
var view = new myView({model: myModel});
myModel.set('name', 'ycs');
</code></pre>
        </div>
    </article>
</div> <!-- blog-body -->